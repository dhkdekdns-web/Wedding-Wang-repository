<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¹„ë°€ì˜ ë°© - 3ë‹¨ê³„ (ê°€ì—”ìŠ¬ì˜ ì•¼ë°”ìœ„)</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            overflow: hidden; /* ìŠ¤í¬ë¡¤ ë°©ì§€ */
            font-family: 'Noto Serif KR', serif;
            background-color: #000;
        }

        /* ë°°ê²½ ì´ë¯¸ì§€ (ì²˜ìŒì—” ëšœë ·í•˜ê²Œ, ë‚˜ì¤‘ì—” ë°˜íˆ¬ëª…í•˜ê²Œ) */
        #bg-image {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('./images/front_smile.jpg') no-repeat center center/cover;
            z-index: 1; /* ì²˜ìŒì— ë§¨ ì•ì— ìˆë„ë¡ */
            transition: opacity 1.5s ease, z-index 1.5s;
            opacity: 1;
        }

        /* 3ì´ˆ ë’¤ì— ì ìš©ë  í´ë˜ìŠ¤ (ë°˜íˆ¬ëª… & ë’¤ë¡œ ë³´ë‚´ê¸°) */
        #bg-image.dimmed {
            opacity: 0.15;
            z-index: -1;
        }

        /* ë©”ì¸ ê²Œì„ ì»¨í…Œì´ë„ˆ (ì²˜ìŒì—” íˆ¬ëª…í•˜ê²Œ ìˆ¨ê¹€) */
        #game-container {
            position: relative;
            z-index: 10;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            opacity: 0;
            transition: opacity 1.5s ease;
            text-align: center;
            padding: 20px;
            box-sizing: border-box;
            pointer-events: none; /* íˆ¬ëª…í•  ë• í´ë¦­ ì•ˆ ë˜ê²Œ */
        }

        /* 3ì´ˆ ë’¤ ê²Œì„ í™”ë©´ ë‚˜íƒ€ë‚  ë•Œ ì ìš© */
        #game-container.show {
            opacity: 1;
            pointer-events: auto;
        }

        h2 {
            color: #ffffff;
            text-shadow: 0 2px 4px rgba(0,0,0,0.8);
            margin-bottom: 10px;
            font-size: 1.3rem;
            word-break: keep-all;
            line-height: 1.5;
        }

        .chance-text {
            color: #ffeb3b;
            font-size: 1.2rem;
            font-weight: bold;
            text-shadow: 0 2px 4px rgba(0,0,0,0.8);
            margin-bottom: 30px;
        }

        /* ìŠ¬ë¼ì„ë“¤ì„ ë‹´ëŠ” ê²©ì */
        #slimes-area {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            max-width: 400px;
            min-height: 200px;
        }

        /* ìŠ¬ë¼ì„ ì¹´ë“œ ë””ìì¸ */
        .slime-box {
            width: 80px;
            height: 80px;
            background-color: #a5d6a7; /* ê°€ì—”ìŠ¬ ëŠë‚Œì˜ ì—°ë‘ìƒ‰ */
            border: 3px solid #81c784;
            border-radius: 50% 50% 15% 15%; /* ì•½ê°„ ë¬¼ë°©ìš¸(ìŠ¬ë¼ì„) ëª¨ì–‘ */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            font-weight: bold;
            color: #2e7d32;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            transition: transform 0.2s;
        }

        .slime-box:hover {
            transform: scale(1.1);
        }

        /* ì„ê¸° ì• ë‹ˆë©”ì´ì…˜ (ëœëœëœ ë–¨ë¦¼) */
        .shuffling {
            animation: shake 0.4s infinite;
            pointer-events: none; /* ì„ëŠ” ì¤‘ì—” í´ë¦­ ë°©ì§€ */
            background-color: #c8e6c9;
        }

        @keyframes shake {
            0% { transform: translate(2px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-2deg); }
            20% { transform: translate(-3px, 0px) rotate(2deg); }
            30% { transform: translate(0px, 2px) rotate(0deg); }
            40% { transform: translate(1px, -1px) rotate(2deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            60% { transform: translate(-3px, 1px) rotate(0deg); }
            70% { transform: translate(2px, 1px) rotate(-2deg); }
            80% { transform: translate(-1px, -1px) rotate(2deg); }
            90% { transform: translate(2px, 2px) rotate(0deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }

        /* ê²°ê³¼ í™”ë©´ ì•„ì´ì½˜ í¬ê¸° */
        .result-icon {
            font-size: 2rem;
        }
    </style>
</head>
<body>

    <div id="bg-image"></div>

    <div id="game-container">
        <h2>ìŠ¬ë¼ì„ì´ ìŒë“œ í•˜í”„ì´ì–´ë§ì„ ìˆ¨ê²¼ì–´ìš”!<br>ì´ê±¸ ì°¾ìœ¼ë©´ ìŒë“œ í•˜í”„ì´ì–´ë§ì„ ì–»ì„ì§€ë„?!</h2>
        <div class="chance-text" id="chance-display">ë‚¨ì€ ê¸°íšŒ 5/5</div>
        
        <div id="slimes-area"></div>
    </div>

    <script>
        let chances = 5;
        let isPlaying = false; // ì„ëŠ” ì¤‘ì´ê±°ë‚˜ ê²°ê³¼ ë³´ì—¬ì£¼ëŠ” ì¤‘ì¼ ë•Œ í´ë¦­ ë°©ì§€

        // 1. í™”ë©´ ë¡œë“œ í›„ 3ì´ˆ(3000ms) ë’¤ì— ì—°ì¶œ ì‹œì‘
        window.addEventListener('load', () => {
            setTimeout(() => {
                document.getElementById('bg-image').classList.add('dimmed');
                document.getElementById('game-container').classList.add('show');
                renderStage(); // ê²Œì„ ì‹œì‘!
            }, 3000);
        });

        // 2. ìŠ¤í…Œì´ì§€ ê·¸ë¦¬ê¸° (ìŠ¬ë¼ì„ ê°œìˆ˜: 6 -> 5 -> 4 -> 3 -> 2)
        function renderStage() {
            const slimesArea = document.getElementById('slimes-area');
            const chanceDisplay = document.getElementById('chance-display');
            
            slimesArea.innerHTML = ''; // ê¸°ì¡´ ìŠ¬ë¼ì„ ì´ˆê¸°í™”
            chanceDisplay.innerText = `ë‚¨ì€ ê¸°íšŒ ${chances}/5`;

            let slimeCount = chances + 1; // ê¸°íšŒê°€ 5ë²ˆì¼ ë•Œ ìŠ¬ë¼ì„ 6ë§ˆë¦¬

            for(let i = 0; i < slimeCount; i++) {
                const slime = document.createElement('div');
                slime.className = 'slime-box';
                slime.innerHTML = 'ğŸ‘¼<br>ê°€ì—”ìŠ¬';
                slime.onclick = () => pickSlime(i, slimeCount);
                slimesArea.appendChild(slime);
            }

            // ìŠ¬ë¼ì„ ë“±ì¥ í›„ ì„ê¸° ì• ë‹ˆë©”ì´ì…˜ ì‹¤í–‰
            shuffleSlimes();
        }

        // 3. ì•¼ë°”ìœ„ ì„ê¸° ì—°ì¶œ
        function shuffleSlimes() {
            isPlaying = true; // ì„ëŠ” ì¤‘ í´ë¦­ ê¸ˆì§€
            const slimes = document.querySelectorAll('.slime-box');
            
            slimes.forEach(slime => slime.classList.add('shuffling'));
            
            // 1.5ì´ˆ ë™ì•ˆ ì„ê³  ë©ˆì¶¤
            setTimeout(() => {
                slimes.forEach(slime => slime.classList.remove('shuffling'));
                isPlaying = false; // ì´ì œ í´ë¦­ ê°€ëŠ¥!
            }, 1500);
        }

        // 4. ìŠ¬ë¼ì„ í´ë¦­ (ì•…ë§ˆì˜ ì£¼ì‘ ì•Œê³ ë¦¬ì¦˜ ë°œë™)
        function pickSlime(pickedIndex, slimeCount) {
            if (isPlaying) return;
            isPlaying = true;

            const slimes = document.querySelectorAll('.slime-box');

            // ì£¼ì‘: ë‚´ê°€ ê³ ë¥¸ ë²ˆí˜¸(pickedIndex)ë¥¼ 'ì œì™¸í•œ' ë‚˜ë¨¸ì§€ ë²ˆí˜¸ ì¤‘ í•˜ë‚˜ë¥¼ ì •ë‹µìœ¼ë¡œ ë§Œë“¦
            let answerIndex;
            do {
                answerIndex = Math.floor(Math.random() * slimeCount);
            } while (answerIndex === pickedIndex);

            // ë‚´ê°€ ê³ ë¥¸ ê±´ ë¬´ì¡°ê±´ ê½ ì²˜ë¦¬
            slimes[pickedIndex].innerHTML = '<div class="result-icon">ğŸ’¥</div>ê½!';
            slimes[pickedIndex].style.backgroundColor = '#ffcdd2'; // ë¹¨ê°„ìƒ‰
            slimes[pickedIndex].style.borderColor = '#ef5350';

            // ì§„ì§œ ìŒë“œ í•˜í”„ì´ì–´ë§ì˜ ìœ„ì¹˜ ë³´ì—¬ì£¼ê¸°
            slimes[answerIndex].innerHTML = '<div class="result-icon">ğŸ’</div>ì—¬ê¸°ì§€ë¡±';
            slimes[answerIndex].style.backgroundColor = '#fff9c4'; // ë…¸ë€ìƒ‰
            slimes[answerIndex].style.borderColor = '#fbc02d';

            // 1.5ì´ˆ ë’¤ì— ë‹¤ìŒ ìŠ¤í…Œì´ì§€ë¡œ ë„˜ì–´ê°€ê±°ë‚˜ ê²Œì„ ì˜¤ë²„ ì²˜ë¦¬
            setTimeout(() => {
                chances--;
                if (chances > 0) {
                    renderStage(); // ë‹¤ìŒ ìŠ¤í…Œì´ì§€(ìŠ¬ë¼ì„ 1ë§ˆë¦¬ ê°ì†Œ) ì§„í–‰
                } else {
                    // ê¸°íšŒ 0ë²ˆ (ìµœì¢… ê²Œì„ ì˜¤ë²„)
                    alert("ëª¨ë“  ê¸°íšŒë¥¼ ìƒì—ˆìŠµë‹ˆë‹¤... ì˜ì›íˆ í•˜í”„ì´ì–´ë§ì„ ì–»ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë„ë°•ì€ ìœ„í—˜í•´ìš”!");
                    // ì›í•˜ì‹ ë‹¤ë©´ ì—¬ê¸°ì„œ easter_1.htmlë¡œ ì«“ì•„ë‚´ì…”ë„ ë©ë‹ˆë‹¤.
                    // window.location.href = "easter_1.html";
                }
            }, 1500);
        }
    </script>
</body>
</html>
