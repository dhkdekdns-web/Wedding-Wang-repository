<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¹„ë°€ì˜ ë°© - 3ë‹¨ê³„ (ê°€ì—”ìŠ¬ì˜ ì•¼ë°”ìœ„)</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            overflow: hidden; 
            font-family: 'Noto Serif KR', serif;
            background-color: #000;
        }

        /* ë°°ê²½ ì´ë¯¸ì§€ */
        #bg-image {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('./images/front_smile.jpg') no-repeat center center/cover;
            z-index: 1; 
            transition: opacity 1.5s ease, z-index 1.5s;
            opacity: 1;
        }

        #bg-image.dimmed {
            opacity: 0.15;
            z-index: -1;
        }

        /* ë©”ì¸ ê²Œì„ ì»¨í…Œì´ë„ˆ */
        #game-container {
            position: relative;
            z-index: 10;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            opacity: 0;
            transition: opacity 1.5s ease;
            text-align: center;
            padding: 20px;
            box-sizing: border-box;
            pointer-events: none; 
        }

        #game-container.show {
            opacity: 1;
            pointer-events: auto;
        }

        h2 {
            color: #ffffff;
            text-shadow: 0 2px 4px rgba(0,0,0,0.8);
            margin-bottom: 10px;
            font-size: 1.3rem;
            word-break: keep-all;
            line-height: 1.5;
        }

        .chance-text {
            color: #ffeb3b;
            font-size: 1.2rem;
            font-weight: bold;
            text-shadow: 0 2px 4px rgba(0,0,0,0.8);
            margin-bottom: 30px;
        }

        /* ìŠ¬ë¼ì„ë“¤ì„ ë‹´ëŠ” ê²©ì */
        #slimes-area {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            max-width: 400px;
            min-height: 200px;
            /* ìŠ¬ë¼ì„ì´ ìœ„ë¡œ ë›°ì–´ì˜¤ë¥¼ ê³µê°„(ì—¬ë°±)ì„ ë¯¸ë¦¬ í™•ë³´í•´ë‘¡ë‹ˆë‹¤ */
            padding-top: 100px; 
        }

        /* ìŠ¬ë¼ì„ê³¼ ì•„ë˜ ìˆ¨ê²¨ì§„ ì•„ì´í…œì„ í•˜ë‚˜ë¡œ ë¬¶ëŠ” ê»ë°ê¸° */
        .slime-wrapper {
            position: relative;
            width: 90px;
            height: 90px;
        }

        /* ë°”ë‹¥ì— ìˆ¨ê²¨ì§„ ê²°ê³¼ (ê¸°ë³¸ì ìœ¼ë¡  ìŠ¬ë¼ì„ì— ê°€ë ¤ ì•ˆ ë³´ì„) */
        .item-underneath {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem; /* ê½(í­íƒ„) ì´ëª¨í‹°ì½˜ í¬ê¸° */
            z-index: 1;
        }

        /* ìŒë“œ í•˜í”„ì´ì–´ë§ ì´ë¯¸ì§€ ì‚¬ì´ì¦ˆ ì¡°ì ˆ */
        .item-underneath img {
            width: 80%;
            height: 80%;
            object-fit: contain;
        }

        /* ë§¨ ìœ„ì— ë®ì—¬ìˆëŠ” ê°€ì—”ìŠ¬ ëšœê»‘ (ë¹„ë””ì˜¤ì™€ ì´ë¯¸ì§€ë¥¼ ë‹´ëŠ” ìƒì) */
        .slime-cover {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
            z-index: 2;
            /* ìœ„ë¡œ ë›°ì–´ì˜¤ë¥´ëŠ” ì• ë‹ˆë©”ì´ì…˜ì„ ë¶€ë“œëŸ½ê²Œ ì„¤ì • */
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
        }

        .slime-cover:hover {
            transform: scale(1.1);
        }

        /* ë‚´ë¶€ ë¹„ë””ì˜¤ ë° ì´ë¯¸ì§€ ê½‰ ì°¨ê²Œ */
        .alive-vid, .dead-img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            pointer-events: none; /* ì‹¤ì œ í´ë¦­ì€ .slime-coverê°€ ë°›ë„ë¡ */
        }

        /* í´ë¦­ ì‹œ ê°€ì—”ìŠ¬ì´ ìœ„ë¡œ ì í”„í•˜ëŠ” í´ë˜ìŠ¤ */
        .slime-cover.lifted {
            /* ìì‹ ì˜ í‚¤(90px)ë§Œí¼ ìœ„ë¡œ ì´ë™ */
            transform: translateY(-100px); 
        }

        /* ì„ê¸° ì• ë‹ˆë©”ì´ì…˜ */
        .shuffling {
            animation: shake 0.4s infinite;
            pointer-events: none; 
        }

        @keyframes shake {
            0% { transform: translate(2px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-2deg); }
            20% { transform: translate(-3px, 0px) rotate(2deg); }
            30% { transform: translate(0px, 2px) rotate(0deg); }
            40% { transform: translate(1px, -1px) rotate(2deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            60% { transform: translate(-3px, 1px) rotate(0deg); }
            70% { transform: translate(2px, 1px) rotate(-2deg); }
            80% { transform: translate(-1px, -1px) rotate(2deg); }
            90% { transform: translate(2px, 2px) rotate(0deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }
    </style>
</head>
<body>

    <div id="bg-image"></div>

    <div id="game-container">
        <h2>ìŠ¬ë¼ì„ì´ ìŒë“œ í•˜í”„ì´ì–´ë§ì„ ìˆ¨ê²¼ì–´ìš”!<br>ì´ê±¸ ì°¾ìœ¼ë©´ ìŒë“œ í•˜í”„ì´ì–´ë§ì„ ì–»ì„ì§€ë„?!</h2>
        <div class="chance-text" id="chance-display">ë‚¨ì€ ê¸°íšŒ 5/5</div>
        
        <div id="slimes-area"></div>
    </div>

    <script>
        let chances = 5;
        let isPlaying = false; 

        // 1. í™”ë©´ ë¡œë“œ í›„ 3ì´ˆ ë’¤ì— ì—°ì¶œ ì‹œì‘
        window.addEventListener('load', () => {
            setTimeout(() => {
                document.getElementById('bg-image').classList.add('dimmed');
                document.getElementById('game-container').classList.add('show');
                renderStage(); 
            }, 3000);
        });

        // 2. ìŠ¤í…Œì´ì§€ ê·¸ë¦¬ê¸°
        function renderStage() {
            const slimesArea = document.getElementById('slimes-area');
            const chanceDisplay = document.getElementById('chance-display');
            
            slimesArea.innerHTML = ''; 
            chanceDisplay.innerText = `ë‚¨ì€ ê¸°íšŒ ${chances}/5`;

            let slimeCount = chances + 1; 

            for(let i = 0; i < slimeCount; i++) {
                // 1. ê»ë°ê¸° ë°•ìŠ¤ ìƒì„±
                const wrapper = document.createElement('div');
                wrapper.className = 'slime-wrapper';

                // 2. ë°”ë‹¥ì— ê¹”ë¦´ ì•„ì´í…œ ì˜ì—­ (ì²˜ìŒì—” ë¹„ì›Œë‘ )
                const underneath = document.createElement('div');
                underneath.className = 'item-underneath';

                // 3. ë®ê³  ìˆì„ ê°€ì—”ìŠ¬ ëšœê»‘ ì»¨í…Œì´ë„ˆ
                const cover = document.createElement('div');
                cover.className = 'slime-cover';
                cover.onclick = () => pickSlime(i, slimeCount);

                // 3-1. ì‚´ì•„ìˆëŠ” ê°€ì—”ìŠ¬ (MP4 ë¹„ë””ì˜¤)
                const aliveVid = document.createElement('video');
                aliveVid.className = 'alive-vid';
                aliveVid.src = './images/ê°€ì—”ìŠ¬.mp4';
                aliveVid.autoplay = true;
                aliveVid.loop = true;
                aliveVid.muted = true;        /* ëª¨ë°”ì¼ ìë™ì¬ìƒ í•„ìˆ˜ ì¡°ê±´ 1 */
                aliveVid.playsInline = true;  /* ëª¨ë°”ì¼ ìë™ì¬ìƒ í•„ìˆ˜ ì¡°ê±´ 2 (ì „ì²´í™”ë©´ ë°©ì§€) */

                // 3-2. ì£½ì€ ê°€ì—”ìŠ¬ (PNG ì´ë¯¸ì§€ - ì²˜ìŒì—” ìˆ¨ê²¨ë‘ )
                const deadImg = document.createElement('img');
                deadImg.className = 'dead-img';
                deadImg.src = './images/ê°€ì—”ìŠ¬_dead.png';
                deadImg.style.display = 'none';

                // ìƒìì— ë‹´ê¸°
                cover.appendChild(aliveVid);
                cover.appendChild(deadImg);
                wrapper.appendChild(underneath);
                wrapper.appendChild(cover);
                slimesArea.appendChild(wrapper);
            }

            shuffleSlimes();
        }

        // 3. ì„ê¸° ì—°ì¶œ
        function shuffleSlimes() {
            isPlaying = true; 
            const covers = document.querySelectorAll('.slime-cover');
            
            covers.forEach(cover => cover.classList.add('shuffling'));
            
            setTimeout(() => {
                covers.forEach(cover => cover.classList.remove('shuffling'));
                isPlaying = false; 
            }, 1500);
        }

        // 4. ìŠ¬ë¼ì„ í´ë¦­ (ì£¼ì‘ ë¡œì§ ì ìš© ë° ì´ë¯¸ì§€ ë³€ê²½)
        function pickSlime(pickedIndex, slimeCount) {
            if (isPlaying) return;
            isPlaying = true;

            const wrappers = document.querySelectorAll('.slime-wrapper');

            // ë‚´ê°€ ê³ ë¥¸ ê±¸ ì œì™¸í•œ ë¬´ì‘ìœ„ ë²ˆí˜¸ í•˜ë‚˜ë¥¼ ì •ë‹µìœ¼ë¡œ ë§Œë“¦
            let answerIndex;
            do {
                answerIndex = Math.floor(Math.random() * slimeCount);
            } while (answerIndex === pickedIndex);

            // [ë‚´ê°€ ê³ ë¥¸ ê²ƒ - ê½]
            const pickedWrapper = wrappers[pickedIndex];
            const pickedUnder = pickedWrapper.querySelector('.item-underneath');
            const pickedCover = pickedWrapper.querySelector('.slime-cover');

            pickedUnder.innerHTML = 'ğŸ’¥'; // ë°‘ì—ëŠ” í­íƒ„ì´ ë‚˜ì˜´
            
            // ë¹„ë””ì˜¤ ë„ê³  ì£½ì€ ì´ë¯¸ì§€ ì¼œê¸°
            pickedCover.querySelector('.alive-vid').style.display = 'none';
            pickedCover.querySelector('.dead-img').style.display = 'block';
            
            pickedCover.classList.add('lifted'); // ìœ„ë¡œ ì í”„!

            // [ì§„ì§œ ì •ë‹µ ìœ„ì¹˜ ë³´ì—¬ì£¼ê¸°]
            const answerWrapper = wrappers[answerIndex];
            const answerUnder = answerWrapper.querySelector('.item-underneath');
            const answerCover = answerWrapper.querySelector('.slime-cover');

            answerUnder.innerHTML = '<img src="./images/í•˜í”„ì´ì–´ë§.png" alt="ìŒë“œ í•˜í”„ì´ì–´ë§">'; // ë°‘ì— ìŒë“œ í•˜í”„ì´ì–´ë§ ë…¸ì¶œ
            answerCover.classList.add('lifted'); // ì–˜ëŠ” ì‚´ì•„ìˆëŠ” ì±„ë¡œ ìœ„ë¡œ ì í”„ì‹œì¼œì„œ ë³´ì—¬ì¤Œ!

            // 1.5ì´ˆ ë’¤ ë‹¤ìŒ ìŠ¤í…Œì´ì§€
            setTimeout(() => {
                chances--;
                if (chances > 0) {
                    renderStage(); 
                } else {
                    alert("ëª¨ë“  ê¸°íšŒë¥¼ ìƒì—ˆìŠµë‹ˆë‹¤... ì˜ì›íˆ í•˜í”„ì´ì–´ë§ì„ ì–»ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë„ë°•ì€ ìœ„í—˜í•´ìš”!");
                    // window.location.href = "easter_1.html"; // íŒ¨ë°° ì‹œ ì´ë™í•  ê³³
                }
            }, 1500);
        }
    </script>
</body>
</html>
